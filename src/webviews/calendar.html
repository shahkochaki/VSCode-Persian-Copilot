<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <title>ØªÙ‚ÙˆÛŒÙ… ÙØ§Ø±Ø³ÛŒ Ùˆ ØªØ¨Ø¯ÛŒÙ„ ØªØ§Ø±ÛŒØ®</title>
    <link rel="icon" type="image/x-icon" href="../favicon.ico">
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Persian Date Library -->
    <script src="https://cdn.jsdelivr.net/npm/persian-date@latest/dist/persian-date.min.js"></script>
    
    <style>
        :root {
            --vscode-foreground: var(--vscode-editor-foreground, #333);
            --vscode-background: var(--vscode-editor-background, #ffffff);
            --vscode-button-background: var(--vscode-button-background, #007acc);
            --vscode-button-foreground: var(--vscode-button-foreground, #ffffff);
            --vscode-input-background: var(--vscode-input-background, #ffffff);
            --vscode-input-border: var(--vscode-input-border, #ccc);
            --vscode-panel-background: var(--vscode-panel-background, #f8f8f8);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Vazirmatn', 'Segoe UI', Tahoma, Arial, sans-serif;
            padding: 24px;
            background: var(--vscode-background);
            color: var(--vscode-foreground);
            direction: rtl;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        h2 {
            text-align: center;
            margin-bottom: 30px;
            color: var(--vscode-button-background);
        }

        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .today, .converter {
            background: var(--vscode-panel-background);
            padding: 20px;
            border-radius: 8px;
            border: 1px solid var(--vscode-input-border);
        }

        .today h3, .converter h3 {
            margin-bottom: 15px;
            color: var(--vscode-button-background);
        }

        .row {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        label {
            min-width: 100%;
            font-weight: 500;
        }

        input, select, button {
            padding: 8px 12px;
            border: 1px solid var(--vscode-input-border);
            border-radius: 4px;
            background: var(--vscode-input-background);
            color: var(--vscode-foreground);
            font-size: 14px;
            font-family: inherit;
        }

        button {
            font-family: inherit;
            background: var(--vscode-button-background);
            color: var(--vscode-button-foreground);
            cursor: pointer;
            font-weight: 500;
        }

        button:hover {
            opacity: 0.9;
        }

        .clear-btn {
            background: #dc3545;
        }

        .result {
            margin-top: 20px;
            padding: 15px;
            background: var(--vscode-input-background);
            border-radius: 8px;
            border: 1px solid var(--vscode-input-border);
        }

        .result-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 15px;
        }

        .date-column {
            padding: 15px;
            background: var(--vscode-panel-background);
            border-radius: 6px;
            border: 1px solid var(--vscode-input-border);
        }

        .date-column h5 {
            margin-bottom: 10px;
            color: var(--vscode-button-background);
            font-size: 16px;
            font-weight: 600;
        }

        .date-number {
            font-size: 20px;
            font-weight: 700;
            color: var(--vscode-foreground);
            margin-bottom: 8px;
            font-family: 'Courier New', monospace;
        }

        .date-full {
            font-size: 14px;
            color: var(--vscode-foreground);
            opacity: 0.8;
        }

        .date-display {
            font-size: 18px;
            font-weight: 600;
            color: var(--vscode-button-background);
            margin-bottom: 8px;
        }

        .date-info {
            font-size: 14px;
            margin-bottom: 5px;
            opacity: 0.8;
        }

        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }
            
            .result-grid {
                grid-template-columns: 1fr;
            }
            
            .row {
                flex-direction: column;
                align-items: stretch;
            }
            
            label {
                min-width: auto;
            }
            
            input, select, button {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h2>ğŸ—“ï¸ ØªÙ‚ÙˆÛŒÙ… ÙØ§Ø±Ø³ÛŒ Ùˆ ØªØ¨Ø¯ÛŒÙ„ ØªØ§Ø±ÛŒØ®</h2>
        
        <div class="grid">
            <!-- Today's Date -->
            <div class="today">
                <h3>ğŸ“… Ø§Ù…Ø±ÙˆØ²</h3>
                <div id="currentDate">Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ...</div>
            </div>

            <!-- Date Converter -->
            <div class="converter">
                <h3>ğŸ”„ ØªØ¨Ø¯ÛŒÙ„ ØªØ§Ø±ÛŒØ®</h3>
                
                <div class="row">
                    <label>ØªØ§Ø±ÛŒØ® Ø´Ù…Ø³ÛŒ:</label>
                    <input type="number" id="jYear" placeholder="1403" min="1300" max="1500" style="width: 80px;">
                    <select id="jMonth" style="width: 120px;">
                        <option value="1">ÙØ±ÙˆØ±Ø¯ÛŒÙ†</option>
                        <option value="2">Ø§Ø±Ø¯ÛŒØ¨Ù‡Ø´Øª</option>
                        <option value="3">Ø®Ø±Ø¯Ø§Ø¯</option>
                        <option value="4">ØªÛŒØ±</option>
                        <option value="5">Ù…Ø±Ø¯Ø§Ø¯</option>
                        <option value="6">Ø´Ù‡Ø±ÛŒÙˆØ±</option>
                        <option value="7">Ù…Ù‡Ø±</option>
                        <option value="8">Ø¢Ø¨Ø§Ù†</option>
                        <option value="9">Ø¢Ø°Ø±</option>
                        <option value="10">Ø¯ÛŒ</option>
                        <option value="11">Ø¨Ù‡Ù…Ù†</option>
                        <option value="12">Ø§Ø³ÙÙ†Ø¯</option>
                    </select>
                    <input type="number" id="jDay" placeholder="1" min="1" max="31" style="width: 60px;">
                    <button onclick="convertToGregorian()">ØªØ¨Ø¯ÛŒÙ„ Ø¨Ù‡ Ù…ÛŒÙ„Ø§Ø¯ÛŒ</button>
                </div>

                <div class="row">
                    <label>ØªØ§Ø±ÛŒØ® Ù…ÛŒÙ„Ø§Ø¯ÛŒ:</label>
                    <input type="date" id="gDate" style="width: 200px;">
                    <button onclick="convertToPersian()">ØªØ¨Ø¯ÛŒÙ„ Ø¨Ù‡ Ø´Ù…Ø³ÛŒ</button>
                </div>
                
                <div class="row">
                    <button onclick="clearAll()" class="clear-btn">ğŸ—‘ï¸ Ù¾Ø§Ú© Ú©Ø±Ø¯Ù†</button>
                    <button onclick="setToday()" style="background:#28a745;">ğŸ“ ØªÙ†Ø¸ÛŒÙ… Ø¨Ù‡ Ø§Ù…Ø±ÙˆØ²</button>
                </div>

                <!-- Result section -->
                <div class="result" id="result"></div>
            </div>
        </div>
    </div>

    <script>
        // Persian to Gregorian conversion
        function jalaliToGregorian(jy, jm, jd) {
            const jy2 = jy + 1595;
            let days = 365 * jy + Math.floor(jy2 / 33) * 8 + Math.floor(((jy2 % 33) + 3) / 4);
            for (let i = 0; i < jm; ++i) {
                days += i < 6 ? 31 : 30;
            }
            if (jm < 6) days += (jm - 1) * 31;
            else days += (jm - 7) * 30 + 186;
            days += jd - 1;
            
            let gy = 400 * Math.floor(days / 146097);
            days %= 146097;
            let leap = true;
            if (days >= 36525) {
                days--;
                const gy2 = Math.floor(days / 36524);
                days %= 36524;
                if (days >= 365) days++;
                gy += gy2 * 100;
            }
            const gy3 = Math.floor(days / 1461);
            days %= 1461;
            if (days >= 366) {
                leap = false;
                days--;
                gy += Math.floor(days / 365) + gy3 * 4;
                days %= 365;
            }
            let gd = days + 1;
            let gm;
            const sal_a = [0, 31, (leap ? 29 : 28), 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
            for (gm = 0; gm < 13; gm++) {
                const v = sal_a[gm];
                if (gd <= v) break;
                gd -= v;
            }
            return [gy + 1600, gm, gd];
        }

        // Gregorian to Persian conversion
        function gregorianToJalali(gy, gm, gd) {
            const g_d_m = [0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334];
            let jy = gy <= 1600 ? 0 : 979;
            gy -= gy <= 1600 ? 621 : 1600;
            const gy2 = gm > 2 ? gy + 1 : gy;
            let days = 365 * gy + Math.floor((gy2 + 3) / 4) - Math.floor((gy2 + 99) / 100) + 
                      Math.floor((gy2 + 399) / 400) - 80 + gd + g_d_m[gm - 1];
            jy += 33 * Math.floor(days / 12053);
            days %= 12053;
            jy += 4 * Math.floor(days / 1461);
            days %= 1461;
            if (days > 365) {
                jy += Math.floor((days - 1) / 365);
                days = (days - 1) % 365;
            }
            let jm, jd;
            if (days < 186) {
                jm = 1 + Math.floor(days / 31);
                jd = 1 + (days % 31);
            } else {
                jm = 7 + Math.floor((days - 186) / 30);
                jd = 1 + ((days - 186) % 30);
            }
            return [jy, jm, jd];
        }

        // Show today's date
        function showTodayDate() {
            if (typeof persianDate !== 'undefined') {
                try {
                    const today = new persianDate();
                    const gregorianToday = today.toCalendar('gregorian');
                    
                    document.getElementById('currentDate').innerHTML = `
                        <div class="date-display">${today.format('D MMMM YYYY')}</div>
                        <div class="date-info">${gregorianToday.format('D MMMM YYYY')}</div>
                        <div class="date-info">âœ… ØªÙ‚ÙˆÛŒÙ… Ø¯Ù‚ÛŒÙ‚ PersianDate</div>
                    `;
                    return;
                } catch (e) {
                    console.error('PersianDate error:', e);
                }
            }
            
            // Fallback
            const today = new Date();
            const [jy, jm, jd] = gregorianToJalali(today.getFullYear(), today.getMonth() + 1, today.getDate());
            const persianMonths = ['ÙØ±ÙˆØ±Ø¯ÛŒÙ†', 'Ø§Ø±Ø¯ÛŒØ¨Ù‡Ø´Øª', 'Ø®Ø±Ø¯Ø§Ø¯', 'ØªÛŒØ±', 'Ù…Ø±Ø¯Ø§Ø¯', 'Ø´Ù‡Ø±ÛŒÙˆØ±', 'Ù…Ù‡Ø±', 'Ø¢Ø¨Ø§Ù†', 'Ø¢Ø°Ø±', 'Ø¯ÛŒ', 'Ø¨Ù‡Ù…Ù†', 'Ø§Ø³ÙÙ†Ø¯'];
            const gregMonths = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
            
            document.getElementById('currentDate').innerHTML = `
                <div class="date-display">${jd} ${persianMonths[jm-1]} ${jy}</div>
                <div class="date-info">${today.getDate()} ${gregMonths[today.getMonth()]} ${today.getFullYear()}</div>
                <div class="date-info">ØªÙ‚ÙˆÛŒÙ… Ø³Ø§Ø¯Ù‡ ÙØ§Ø±Ø³ÛŒ</div>
            `;
        }

        // Set today's date in inputs
        function setToday() {
            const today = new Date();
            const [jy, jm, jd] = gregorianToJalali(today.getFullYear(), today.getMonth() + 1, today.getDate());
            
            document.getElementById('jYear').value = jy;
            document.getElementById('jMonth').value = jm;
            document.getElementById('jDay').value = jd;
            
            const isoDate = today.toISOString().split('T')[0];
            document.getElementById('gDate').value = isoDate;
            
            document.getElementById('result').innerHTML = `
                <h4>âœ… ØªØ§Ø±ÛŒØ® Ø§Ù…Ø±ÙˆØ² ØªÙ†Ø¸ÛŒÙ… Ø´Ø¯:</h4>
                <div class="result-grid">
                    <div class="date-column">
                        <h5>ØªØ§Ø±ÛŒØ® Ø®ÙˆØ±Ø´ÛŒØ¯ÛŒ</h5>
                        <div class="date-number">${jy}/${String(jm).padStart(2, '0')}/${String(jd).padStart(2, '0')}</div>
                        <div class="date-full">${jd} ${['ÙØ±ÙˆØ±Ø¯ÛŒÙ†', 'Ø§Ø±Ø¯ÛŒØ¨Ù‡Ø´Øª', 'Ø®Ø±Ø¯Ø§Ø¯', 'ØªÛŒØ±', 'Ù…Ø±Ø¯Ø§Ø¯', 'Ø´Ù‡Ø±ÛŒÙˆØ±', 'Ù…Ù‡Ø±', 'Ø¢Ø¨Ø§Ù†', 'Ø¢Ø°Ø±', 'Ø¯ÛŒ', 'Ø¨Ù‡Ù…Ù†', 'Ø§Ø³ÙÙ†Ø¯'][jm-1]} ${jy}</div>
                    </div>
                    <div class="date-column">
                        <h5>ØªØ§Ø±ÛŒØ® Ù…ÛŒÙ„Ø§Ø¯ÛŒ</h5>
                        <div class="date-number">${today.getFullYear()}-${String(today.getMonth() + 1).padStart(2, '0')}-${String(today.getDate()).padStart(2, '0')}</div>
                        <div class="date-full">${today.getDate()} ${['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'][today.getMonth()]} ${today.getFullYear()}</div>
                    </div>
                </div>
            `;
        }

        // Convert Persian to Gregorian
        function convertToGregorian() {
            const jy = parseInt(document.getElementById('jYear').value);
            const jm = parseInt(document.getElementById('jMonth').value);
            const jd = parseInt(document.getElementById('jDay').value);
            
            if (!jy || !jm || !jd) {
                document.getElementById('result').innerHTML = '<span style="color:#dc3545;">âŒ Ù„Ø·ÙØ§Ù‹ ØªÙ…Ø§Ù… ÙÛŒÙ„Ø¯Ù‡Ø§ Ø±Ø§ Ù¾Ø± Ú©Ù†ÛŒØ¯</span>';
                return;
            }
            
            try {
                if (typeof persianDate !== 'undefined') {
                    const persianDateObj = new persianDate([jy, jm, jd]);
                    const gregorianDateObj = persianDateObj.toCalendar('gregorian');
                    
                    const isoDate = `${gregorianDateObj.year()}-${String(gregorianDateObj.month()).padStart(2, '0')}-${String(gregorianDateObj.date()).padStart(2, '0')}`;
                    document.getElementById('gDate').value = isoDate;
                    
                    document.getElementById('result').innerHTML = `
                        <h4>âœ… Ù†ØªÛŒØ¬Ù‡ ØªØ¨Ø¯ÛŒÙ„:</h4>
                        <div class="result-grid">
                            <div class="date-column">
                                <h5>ØªØ§Ø±ÛŒØ® Ø®ÙˆØ±Ø´ÛŒØ¯ÛŒ</h5>
                                <div class="date-number">${jy}/${String(jm).padStart(2, '0')}/${String(jd).padStart(2, '0')}</div>
                                <div class="date-full">${persianDateObj.format('dddd')} - ${persianDateObj.format('D MMMM YYYY')}</div>
                            </div>
                            <div class="date-column">
                                <h5>ØªØ§Ø±ÛŒØ® Ù…ÛŒÙ„Ø§Ø¯ÛŒ</h5>
                                <div class="date-number">${isoDate}</div>
                                <div class="date-full">${gregorianDateObj.format('dddd')} - ${gregorianDateObj.format('MMMM D, YYYY')}</div>
                            </div>
                        </div>
                    `;
                } else {
                    const [gy, gm, gd] = jalaliToGregorian(jy, jm, jd);
                    const persianMonths = ['ÙØ±ÙˆØ±Ø¯ÛŒÙ†', 'Ø§Ø±Ø¯ÛŒØ¨Ù‡Ø´Øª', 'Ø®Ø±Ø¯Ø§Ø¯', 'ØªÛŒØ±', 'Ù…Ø±Ø¯Ø§Ø¯', 'Ø´Ù‡Ø±ÛŒÙˆØ±', 'Ù…Ù‡Ø±', 'Ø¢Ø¨Ø§Ù†', 'Ø¢Ø°Ø±', 'Ø¯ÛŒ', 'Ø¨Ù‡Ù…Ù†', 'Ø§Ø³ÙÙ†Ø¯'];
                    const gregMonths = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
                    
                    const isoDate = `${gy}-${String(gm).padStart(2, '0')}-${String(gd).padStart(2, '0')}`;
                    document.getElementById('gDate').value = isoDate;
                    
                    document.getElementById('result').innerHTML = `
                        <h4>âœ… Ù†ØªÛŒØ¬Ù‡ ØªØ¨Ø¯ÛŒÙ„:</h4>
                        <div class="result-grid">
                            <div class="date-column">
                                <h5>ØªØ§Ø±ÛŒØ® Ø®ÙˆØ±Ø´ÛŒØ¯ÛŒ</h5>
                                <div class="date-number">${jy}/${String(jm).padStart(2, '0')}/${String(jd).padStart(2, '0')}</div>
                                <div class="date-full">${jd} ${persianMonths[jm-1]} ${jy}</div>
                            </div>
                            <div class="date-column">
                                <h5>ØªØ§Ø±ÛŒØ® Ù…ÛŒÙ„Ø§Ø¯ÛŒ</h5>
                                <div class="date-number">${isoDate}</div>
                                <div class="date-full">${gd} ${gregMonths[gm-1]}, ${gy}</div>
                            </div>
                        </div>
                    `;
                }
                
            } catch (e) {
                console.error('Conversion error:', e);
                document.getElementById('result').innerHTML = '<span style="color:#dc3545;">âŒ Ø®Ø·Ø§ Ø¯Ø± ØªØ¨Ø¯ÛŒÙ„ ØªØ§Ø±ÛŒØ®: ' + e.message + '</span>';
            }
        }

        // Convert Gregorian to Persian
        function convertToPersian() {
            const gDate = document.getElementById('gDate').value;
            if (!gDate) {
                document.getElementById('result').innerHTML = '<span style="color:#dc3545;">âŒ Ù„Ø·ÙØ§Ù‹ ØªØ§Ø±ÛŒØ® Ù…ÛŒÙ„Ø§Ø¯ÛŒ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</span>';
                return;
            }
            
            try {
                const date = new Date(gDate);
                
                if (typeof persianDate !== 'undefined') {
                    const gregorianDateObj = new persianDate(date).toCalendar('gregorian');
                    const persianDateObj = gregorianDateObj.toCalendar('persian');
                    
                    document.getElementById('jYear').value = persianDateObj.year();
                    document.getElementById('jMonth').value = persianDateObj.month();
                    document.getElementById('jDay').value = persianDateObj.date();
                    
                    document.getElementById('result').innerHTML = `
                        <h4>âœ… Ù†ØªÛŒØ¬Ù‡ ØªØ¨Ø¯ÛŒÙ„:</h4>
                        <div class="result-grid">
                            <div class="date-column">
                                <h5>ØªØ§Ø±ÛŒØ® Ø®ÙˆØ±Ø´ÛŒØ¯ÛŒ</h5>
                                <div class="date-number">${persianDateObj.year()}/${String(persianDateObj.month()).padStart(2, '0')}/${String(persianDateObj.date()).padStart(2, '0')}</div>
                                <div class="date-full">${persianDateObj.format('dddd')} - ${persianDateObj.format('D MMMM YYYY')}</div>
                            </div>
                            <div class="date-column">
                                <h5>ØªØ§Ø±ÛŒØ® Ù…ÛŒÙ„Ø§Ø¯ÛŒ</h5>
                                <div class="date-number">${gregorianDateObj.year()}-${String(gregorianDateObj.month()).padStart(2, '0')}-${String(gregorianDateObj.date()).padStart(2, '0')}</div>
                                <div class="date-full">${gregorianDateObj.format('dddd')} - ${gregorianDateObj.format('MMMM D, YYYY')}</div>
                            </div>
                        </div>
                    `;
                } else {
                    const gy = date.getFullYear();
                    const gm = date.getMonth() + 1;
                    const gd = date.getDate();
                    
                    const [jy, jm, jd] = gregorianToJalali(gy, gm, gd);
                    const persianMonths = ['ÙØ±ÙˆØ±Ø¯ÛŒÙ†', 'Ø§Ø±Ø¯ÛŒØ¨Ù‡Ø´Øª', 'Ø®Ø±Ø¯Ø§Ø¯', 'ØªÛŒØ±', 'Ù…Ø±Ø¯Ø§Ø¯', 'Ø´Ù‡Ø±ÛŒÙˆØ±', 'Ù…Ù‡Ø±', 'Ø¢Ø¨Ø§Ù†', 'Ø¢Ø°Ø±', 'Ø¯ÛŒ', 'Ø¨Ù‡Ù…Ù†', 'Ø§Ø³ÙÙ†Ø¯'];
                    const gregMonths = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
                    
                    document.getElementById('jYear').value = jy;
                    document.getElementById('jMonth').value = jm;
                    document.getElementById('jDay').value = jd;
                    
                    document.getElementById('result').innerHTML = `
                        <h4>âœ… Ù†ØªÛŒØ¬Ù‡ ØªØ¨Ø¯ÛŒÙ„:</h4>
                        <div class="result-grid">
                            <div class="date-column">
                                <h5>ØªØ§Ø±ÛŒØ® Ø®ÙˆØ±Ø´ÛŒØ¯ÛŒ</h5>
                                <div class="date-number">${jy}/${String(jm).padStart(2, '0')}/${String(jd).padStart(2, '0')}</div>
                                <div class="date-full">${jd} ${persianMonths[jm-1]} ${jy}</div>
                            </div>
                            <div class="date-column">
                                <h5>ØªØ§Ø±ÛŒØ® Ù…ÛŒÙ„Ø§Ø¯ÛŒ</h5>
                                <div class="date-number">${gy}-${String(gm).padStart(2, '0')}-${String(gd).padStart(2, '0')}</div>
                                <div class="date-full">${gd} ${gregMonths[gm-1]}, ${gy}</div>
                            </div>
                        </div>
                    `;
                }
                
            } catch (e) {
                console.error('Conversion error:', e);
                document.getElementById('result').innerHTML = '<span style="color:#dc3545;">âŒ Ø®Ø·Ø§ Ø¯Ø± ØªØ¨Ø¯ÛŒÙ„ ØªØ§Ø±ÛŒØ®: ' + e.message + '</span>';
            }
        }

        // Clear all inputs
        function clearAll() {
            document.getElementById('jYear').value = '';
            document.getElementById('jMonth').value = '1';
            document.getElementById('jDay').value = '';
            document.getElementById('gDate').value = '';
            document.getElementById('result').innerHTML = '';
        }

        // Initialize when page loads
        window.addEventListener('load', function() {
            showTodayDate();
            setToday();
        });
    </script>
</body>
</html>
