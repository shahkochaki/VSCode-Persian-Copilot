<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <title>ØªÙ‚ÙˆÛŒÙ… ÙØ§Ø±Ø³ÛŒ Ùˆ ØªØ¨Ø¯ÛŒÙ„ ØªØ§Ø±ÛŒØ®</title>
    <link rel="icon" type="image/x-icon" href="../favicon.ico">
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Persian Date Library -->
    <script src="https://cdn.jsdelivr.net/npm/persian-date@latest/dist/persian-date.min.js"></script>
    
    <style>
        :root {
            --vscode-foreground: var(--vscode-editor-foreground, #333);
            --vscode-background: var(--vscode-editor-background, #ffffff);
            --vscode-button-background: var(--vscode-button-background, #007acc);
            --vscode-button-foreground: var(--vscode-button-foreground, #ffffff);
            --vscode-input-background: var(--vscode-input-background, #ffffff);
            --vscode-input-border: var(--vscode-input-border, #ccc);
            --vscode-panel-background: var(--vscode-panel-background, #f8f8f8);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Vazirmatn', 'Segoe UI', Tahoma, Arial, sans-serif;
            padding: 24px;
            background: var(--vscode-background);
            color: var(--vscode-foreground);
            direction: rtl;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        h2 {
            text-align: center;
            margin-bottom: 30px;
            color: var(--vscode-button-background);
        }

        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .today, .converter {
            background: var(--vscode-panel-background);
            padding: 20px;
            border-radius: 8px;
            border: 1px solid var(--vscode-input-border);
        }

        .today h3, .converter h3 {
            margin-bottom: 15px;
            color: var(--vscode-button-background);
        }

        .row {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        label {
            min-width: 100%;
            font-weight: 500;
        }

        input, select, button {
            padding: 8px 12px;
            border: 1px solid var(--vscode-input-border);
            border-radius: 4px;
            background: var(--vscode-input-background);
            color: var(--vscode-foreground);
            font-size: 14px;
            font-family: inherit;
        }

        button {
            font-family: inherit;
            background: var(--vscode-button-background);
            color: var(--vscode-button-foreground);
            cursor: pointer;
            font-weight: 500;
        }

        button:hover {
            opacity: 0.9;
        }

        .clear-btn {
            background: #dc3545;
        }

        .result {
            margin-top: 20px;
            padding: 15px;
            background: var(--vscode-input-background);
            border-radius: 8px;
            border: 1px solid var(--vscode-input-border);
        }

        .result-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 15px;
        }

        .date-column {
            padding: 15px;
            background: var(--vscode-panel-background);
            border-radius: 6px;
            border: 1px solid var(--vscode-input-border);
        }

        .date-column h5 {
            margin-bottom: 10px;
            color: var(--vscode-button-background);
            font-size: 16px;
            font-weight: 600;
        }

        .date-number {
            font-size: 20px;
            font-weight: 700;
            color: var(--vscode-foreground);
            margin-bottom: 8px;
            font-family: 'Courier New', monospace;
        }

        .date-full {
            font-size: 14px;
            color: var(--vscode-foreground);
            opacity: 0.8;
        }

        .date-display {
            font-size: 18px;
            font-weight: 600;
            color: var(--vscode-button-background);
            margin-bottom: 8px;
        }

        .date-info {
            font-size: 14px;
            margin-bottom: 5px;
            opacity: 0.8;
        }

        /* Calendar Widget Styles */
        .calendar-widget {
            width: 100%;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            font-size: 16px;
            font-weight: 600;
        }

        .nav-btn {
            background: var(--vscode-button-background);
            color: var(--vscode-button-foreground);
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .nav-btn:hover {
            opacity: 0.8;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 2px;
            margin-top: 10px;
        }

        .day-header {
            font-size: 12px;
            padding: 6px 4px;
            background: var(--vscode-panel-background);
            border-radius: 3px;
            font-weight: 600;
            text-align: center;
            color: var(--vscode-button-background);
        }

        .day-cell {
            padding: 8px 4px;
            border-radius: 3px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 13px;
            min-height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--vscode-input-background);
            border: 1px solid transparent;
        }

        .day-cell:hover {
            background: var(--vscode-panel-background);
            border-color: var(--vscode-input-border);
        }

        .day-cell.today {
            background: linear-gradient(135deg, #ff6b6b, #ff8e8e);
            color: white;
            font-weight: 700;
            /* border: 2px solid #ff4757; */
            box-shadow: 0 4px 12px rgba(255, 107, 107, 0.3);
            transform: scale(1.1);
            position: relative;
            animation: pulse 2s infinite;
        }

        .day-cell.today::before {
            content: 'ğŸŒŸ';
            position: absolute;
            top: -3px;
            right: -3px;
            font-size: 10px;
        }

        .day-cell.selected {
            background: linear-gradient(135deg, #28a745, #34ce57);
            color: white;
            font-weight: 600;
            /* border: 2px solid #20c997; */
            box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);
            transform: scale(1.05);
        }

        .day-cell.selected::before {
            content: 'âœ“';
            position: absolute;
            top: -3px;
            right: -3px;
            font-size: 10px;
            color: white;
            background: #004b0a;
            border-radius: 50%;
            width: 14px;
            height: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        @keyframes pulse {
            0% { box-shadow: 0 4px 12px rgba(255, 107, 107, 0.3); }
            50% { box-shadow: 0 6px 20px rgba(255, 107, 107, 0.5); }
            100% { box-shadow: 0 4px 12px rgba(255, 107, 107, 0.3); }
        }

        .day-cell.other-month {
            opacity: 0.3;
            cursor: default;
        }

        .day-cell.other-month:hover {
            background: var(--vscode-input-background);
            border-color: transparent;
        }

        /* Today's date display styles */
        .today-display {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 12px;
            padding: 15px;
            color: white;
            text-align: center;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.2);
            margin-top: 15px;
            position: relative;
            overflow: hidden;
        }

        .today-display::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
            transform: rotate(45deg);
            animation: shine 3s infinite;
        }

        @keyframes shine {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            50% { transform: translateX(100%) translateY(100%) rotate(45deg); }
            100% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
        }

        .today-emoji {
            font-size: 24px;
            margin-bottom: 8px;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        .date-display {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
            position: relative;
            z-index: 1;
        }

        .date-info {
            font-size: 14px;
            margin-bottom: 5px;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }

        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }
            
            .result-grid {
                grid-template-columns: 1fr;
            }
            
            .row {
                flex-direction: column;
                align-items: stretch;
            }
            
            label {
                min-width: auto;
            }
            
            input, select, button {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h2>ğŸ—“ï¸ ØªÙ‚ÙˆÛŒÙ… ÙØ§Ø±Ø³ÛŒ Ùˆ ØªØ¨Ø¯ÛŒÙ„ ØªØ§Ø±ÛŒØ®</h2>
        
        <div class="grid">
                        <!-- Date Converter -->
            <div class="converter">
                <h3>ğŸ”„ ØªØ¨Ø¯ÛŒÙ„ ØªØ§Ø±ÛŒØ®</h3>
                
                <div class="row">
                    <label>ØªØ§Ø±ÛŒØ® Ø´Ù…Ø³ÛŒ:</label>
                    <input type="number" id="jYear" placeholder="1403" min="1300" max="1500" style="width: 80px;">
                    <select id="jMonth" style="width: 120px;">
                        <option value="1">ÙØ±ÙˆØ±Ø¯ÛŒÙ†</option>
                        <option value="2">Ø§Ø±Ø¯ÛŒØ¨Ù‡Ø´Øª</option>
                        <option value="3">Ø®Ø±Ø¯Ø§Ø¯</option>
                        <option value="4">ØªÛŒØ±</option>
                        <option value="5">Ù…Ø±Ø¯Ø§Ø¯</option>
                        <option value="6">Ø´Ù‡Ø±ÛŒÙˆØ±</option>
                        <option value="7">Ù…Ù‡Ø±</option>
                        <option value="8">Ø¢Ø¨Ø§Ù†</option>
                        <option value="9">Ø¢Ø°Ø±</option>
                        <option value="10">Ø¯ÛŒ</option>
                        <option value="11">Ø¨Ù‡Ù…Ù†</option>
                        <option value="12">Ø§Ø³ÙÙ†Ø¯</option>
                    </select>
                    <input type="number" id="jDay" placeholder="1" min="1" max="31" style="width: 60px;">
                    <button onclick="convertToGregorian()">ØªØ¨Ø¯ÛŒÙ„ Ø¨Ù‡ Ù…ÛŒÙ„Ø§Ø¯ÛŒ</button>
                </div>

                <div class="row">
                    <label>ØªØ§Ø±ÛŒØ® Ù…ÛŒÙ„Ø§Ø¯ÛŒ:</label>
                    <input type="date" id="gDate" style="width: 200px;">
                    <button onclick="convertToPersian()">ØªØ¨Ø¯ÛŒÙ„ Ø¨Ù‡ Ø´Ù…Ø³ÛŒ</button>
                </div>
                
                <div class="row">
                    <button onclick="clearAll()" class="clear-btn">ğŸ—‘ï¸ Ù¾Ø§Ú© Ú©Ø±Ø¯Ù†</button>
                    <button onclick="setToday()" style="background:#28a745;">ğŸ“ ØªÙ†Ø¸ÛŒÙ… Ø¨Ù‡ Ø§Ù…Ø±ÙˆØ²</button>
                </div>

                <!-- Result section -->
                <div class="result" id="result"></div>
            </div>

            <!-- Persian Calendar Widget -->
            <div class="today">
                <h3>ğŸ“… ØªÙ‚ÙˆÛŒÙ… Ø´Ù…Ø³ÛŒ</h3>
                <div class="calendar-widget">
                    <div class="calendar-header">
                        <button class="nav-btn" onclick="previousMonth()">â®</button>
                        <div id="currentMonth">Loading...</div>
                        <button class="nav-btn" onclick="nextMonth()">â¯</button>
                    </div>
                    <div class="calendar-grid" id="calendarGrid">
                        <!-- Calendar will be generated here -->
                    </div>
                </div>
                <div id="currentDate" class="today-display">
                    <div class="today-emoji">ğŸ“…</div>
                    <!-- Today's date will be shown here -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables for calendar
        let currentCalendarYear = 1403;
        let currentCalendarMonth = 1;
        let selectedDay = null;
        let selectedMonth = null;
        let selectedYear = null;

        // Simplified Persian to Gregorian conversion
        function jalaliToGregorian(jy, jm, jd) {
            // Hard-coded for current year 1403
            if (jy === 1403) {
                const monthOffsets = [
                    0,      // ÙØ±ÙˆØ±Ø¯ÛŒÙ† starts at March 20, 2024
                    31,     // Ø§Ø±Ø¯ÛŒØ¨Ù‡Ø´Øª starts at April 20, 2024  
                    62,     // Ø®Ø±Ø¯Ø§Ø¯ starts at May 21, 2024
                    93,     // ØªÛŒØ± starts at June 21, 2024
                    124,    // Ù…Ø±Ø¯Ø§Ø¯ starts at July 22, 2024
                    155,    // Ø´Ù‡Ø±ÛŒÙˆØ± starts at August 22, 2024
                    186,    // Ù…Ù‡Ø± starts at September 22, 2024
                    216,    // Ø¢Ø¨Ø§Ù† starts at October 22, 2024
                    246,    // Ø¢Ø°Ø± starts at November 21, 2024
                    276,    // Ø¯ÛŒ starts at December 21, 2024
                    306,    // Ø¨Ù‡Ù…Ù† starts at January 20, 2025
                    336     // Ø§Ø³ÙÙ†Ø¯ starts at February 19, 2025
                ];
                
                const baseDate = new Date(2024, 2, 20); // March 20, 2024 = 1 Farvardin 1403
                const dayOffset = monthOffsets[jm - 1] + jd - 1;
                const resultDate = new Date(baseDate.getTime() + dayOffset * 24 * 60 * 60 * 1000);
                return [resultDate.getFullYear(), resultDate.getMonth() + 1, resultDate.getDate()];
            }
            
            // Fallback to approximate calculation for other years
            const baseYear = 1403;
            const baseDate = new Date(2024, 2, 20);
            const yearDiff = jy - baseYear;
            const approxDate = new Date(baseDate.getFullYear() + yearDiff, baseDate.getMonth(), baseDate.getDate());
            return [approxDate.getFullYear(), approxDate.getMonth() + 1, approxDate.getDate()];
        }

        // Gregorian to Persian conversion
        function gregorianToJalali(gy, gm, gd) {
            const g_d_m = [0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334];
            let jy = gy <= 1600 ? 0 : 979;
            gy -= gy <= 1600 ? 621 : 1600;
            const gy2 = gm > 2 ? gy + 1 : gy;
            let days = 365 * gy + Math.floor((gy2 + 3) / 4) - Math.floor((gy2 + 99) / 100) + 
                      Math.floor((gy2 + 399) / 400) - 80 + gd + g_d_m[gm - 1];
            jy += 33 * Math.floor(days / 12053);
            days %= 12053;
            jy += 4 * Math.floor(days / 1461);
            days %= 1461;
            if (days > 365) {
                jy += Math.floor((days - 1) / 365);
                days = (days - 1) % 365;
            }
            let jm, jd;
            if (days < 186) {
                jm = 1 + Math.floor(days / 31);
                jd = 1 + (days % 31);
            } else {
                jm = 7 + Math.floor((days - 186) / 30);
                jd = 1 + ((days - 186) % 30);
            }
            return [jy, jm, jd];
        }

        // Calendar rendering functions
        function renderCalendar() {
            const persianMonths = ['ÙØ±ÙˆØ±Ø¯ÛŒÙ†', 'Ø§Ø±Ø¯ÛŒØ¨Ù‡Ø´Øª', 'Ø®Ø±Ø¯Ø§Ø¯', 'ØªÛŒØ±', 'Ù…Ø±Ø¯Ø§Ø¯', 'Ø´Ù‡Ø±ÛŒÙˆØ±', 'Ù…Ù‡Ø±', 'Ø¢Ø¨Ø§Ù†', 'Ø¢Ø°Ø±', 'Ø¯ÛŒ', 'Ø¨Ù‡Ù…Ù†', 'Ø§Ø³ÙÙ†Ø¯'];
            const dayNames = ['Ø´', 'ÛŒ', 'Ø¯', 'Ø³', 'Ú†', 'Ù¾', 'Ø¬'];
            
            document.getElementById('currentMonth').textContent = persianMonths[currentCalendarMonth - 1] + ' ' + currentCalendarYear;
            
            const grid = document.getElementById('calendarGrid');
            grid.innerHTML = '';
            
            // Add day headers
            dayNames.forEach(day => {
                const dayHeader = document.createElement('div');
                dayHeader.className = 'day-header';
                dayHeader.textContent = day;
                grid.appendChild(dayHeader);
            });
            
            // Get first day of month
            const firstDayGregorian = jalaliToGregorian(currentCalendarYear, currentCalendarMonth, 1);
            const firstDay = new Date(firstDayGregorian[0], firstDayGregorian[1] - 1, firstDayGregorian[2]);
            const startDayOfWeek = (firstDay.getDay() + 1) % 7; // Adjust for Persian week start (Saturday = 0)
            
            // Days in current month
            const daysInMonth = (currentCalendarMonth <= 6) ? 31 : (currentCalendarMonth <= 11) ? 30 : 29;
            
            // Today's date for highlighting
            const today = new Date();
            const todayJalali = gregorianToJalali(today.getFullYear(), today.getMonth() + 1, today.getDate());
            const todayJy = todayJalali[0];
            const todayJm = todayJalali[1];
            const todayJd = todayJalali[2];
            
            // Add empty cells for days before month starts
            for (let i = 0; i < startDayOfWeek; i++) {
                const emptyCell = document.createElement('div');
                emptyCell.className = 'day-cell other-month';
                grid.appendChild(emptyCell);
            }
            
            // Add days of the month
            for (let day = 1; day <= daysInMonth; day++) {
                const dayCell = document.createElement('div');
                dayCell.className = 'day-cell';
                dayCell.textContent = day;
                
                // Highlight today
                if (currentCalendarYear === todayJy && currentCalendarMonth === todayJm && day === todayJd) {
                    dayCell.classList.add('today');
                }
                
                // Highlight selected day
                if (selectedYear === currentCalendarYear && selectedMonth === currentCalendarMonth && selectedDay === day) {
                    dayCell.classList.add('selected');
                }
                
                dayCell.onclick = () => selectCalendarDate(day);
                grid.appendChild(dayCell);
            }
        }

        function selectCalendarDate(day) {
            // Update selected date variables
            selectedDay = day;
            selectedMonth = currentCalendarMonth;
            selectedYear = currentCalendarYear;
            
            // Update form inputs
            document.getElementById('jYear').value = currentCalendarYear;
            document.getElementById('jMonth').value = currentCalendarMonth;
            document.getElementById('jDay').value = day;
            
            // Re-render calendar to show selection
            renderCalendar();
            
            // Convert to Gregorian
            convertToGregorian();
        }

        function previousMonth() {
            currentCalendarMonth--;
            if (currentCalendarMonth < 1) {
                currentCalendarMonth = 12;
                currentCalendarYear--;
            }
            renderCalendar();
        }

        function nextMonth() {
            currentCalendarMonth++;
            if (currentCalendarMonth > 12) {
                currentCalendarMonth = 1;
                currentCalendarYear++;
            }
            renderCalendar();
        }

        // Show today's date
        function showTodayDate() {
            if (typeof persianDate !== 'undefined') {
                try {
                    const today = new persianDate();
                    const gregorianToday = today.toCalendar('gregorian');
                    
                    // Get Persian date parts
                    const persianDateStr = today.format('D MMMM YYYY');
                    
                    // Get Gregorian date in English
                    const gregYear = gregorianToday.year();
                    const gregMonth = gregorianToday.month();
                    const gregDay = gregorianToday.date();
                    const gregMonthsEng = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
                    const gregDateStr = gregDay + ' ' + gregMonthsEng[gregMonth - 1] + ' ' + gregYear;
                    
                    document.getElementById('currentDate').innerHTML = 
                        '<div class="today-emoji">ğŸŒŸ</div>' +
                        '<div class="date-display">' + persianDateStr + '</div>' +
                        '<div class="date-info">' + gregDateStr + '</div>' +
                        '<div class="date-info">âœ¨ ØªÙˆØ³Ø¹Ù‡ ØªÙˆØ³Ø· Ù…Ø¬Ù…ÙˆØ¹Ù‡ Ø§Ø¨Ø²Ø§Ø± Ù‡Ø§ÛŒ Helpix âœ¨</div>';
                    return;
                } catch (e) {
                    console.error('PersianDate error:', e);
                }
            }
            
            // Fallback
            const today = new Date();
            const jalaliToday = gregorianToJalali(today.getFullYear(), today.getMonth() + 1, today.getDate());
            const jy = jalaliToday[0];
            const jm = jalaliToday[1];
            const jd = jalaliToday[2];
            
            const persianMonths = ['ÙØ±ÙˆØ±Ø¯ÛŒÙ†', 'Ø§Ø±Ø¯ÛŒØ¨Ù‡Ø´Øª', 'Ø®Ø±Ø¯Ø§Ø¯', 'ØªÛŒØ±', 'Ù…Ø±Ø¯Ø§Ø¯', 'Ø´Ù‡Ø±ÛŒÙˆØ±', 'Ù…Ù‡Ø±', 'Ø¢Ø¨Ø§Ù†', 'Ø¢Ø°Ø±', 'Ø¯ÛŒ', 'Ø¨Ù‡Ù…Ù†', 'Ø§Ø³ÙÙ†Ø¯'];
            const gregMonths = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
            
            const persianDateStr = jd + ' ' + persianMonths[jm-1] + ' ' + jy;
            const gregDateStr = today.getDate() + ' ' + gregMonths[today.getMonth()] + ' ' + today.getFullYear();
            
            // Get day of week
            const dayNames = ['ÛŒÚ©Ø´Ù†Ø¨Ù‡', 'Ø¯ÙˆØ´Ù†Ø¨Ù‡', 'Ø³Ù‡â€ŒØ´Ù†Ø¨Ù‡', 'Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡', 'Ù¾Ù†Ø¬â€ŒØ´Ù†Ø¨Ù‡', 'Ø¬Ù…Ø¹Ù‡', 'Ø´Ù†Ø¨Ù‡'];
            const dayName = dayNames[today.getDay()];
            
            document.getElementById('currentDate').innerHTML = 
                '<div class="today-emoji">ğŸŒŸ</div>' +
                '<div class="date-display">' + persianDateStr + '</div>' +
                '<div class="date-info">' + dayName + ' â€¢ ' + gregDateStr + '</div>' +
                '<div class="date-info">âœ¨ Ø§Ù…Ø±ÙˆØ² Ø±ÙˆØ² Ø®ÙˆØ¨ÛŒ Ø§Ø³Øª! âœ¨</div>';
        }

        // Set today's date in inputs
        function setToday() {
            const today = new Date();
            const jalaliToday = gregorianToJalali(today.getFullYear(), today.getMonth() + 1, today.getDate());
            const jy = jalaliToday[0];
            const jm = jalaliToday[1];
            const jd = jalaliToday[2];
            
            document.getElementById('jYear').value = jy;
            document.getElementById('jMonth').value = jm;
            document.getElementById('jDay').value = jd;
            
            const isoDate = today.toISOString().split('T')[0];
            document.getElementById('gDate').value = isoDate;
            
            // Update calendar to current month
            currentCalendarYear = jy;
            currentCalendarMonth = jm;
            
            // Set selected date to today
            selectedDay = jd;
            selectedMonth = jm;
            selectedYear = jy;
            
            renderCalendar();
            
            document.getElementById('result').innerHTML = 
                '<h4>âœ… ØªØ§Ø±ÛŒØ® Ø§Ù…Ø±ÙˆØ² ØªÙ†Ø¸ÛŒÙ… Ø´Ø¯:</h4>' +
                '<div class="result-grid">' +
                    '<div class="date-column">' +
                        '<h5>ØªØ§Ø±ÛŒØ® Ø®ÙˆØ±Ø´ÛŒØ¯ÛŒ</h5>' +
                        '<div class="date-number">' + jy + '/' + String(jm).padStart(2, '0') + '/' + String(jd).padStart(2, '0') + '</div>' +
                        '<div class="date-full">' + jd + ' ' + ['ÙØ±ÙˆØ±Ø¯ÛŒÙ†', 'Ø§Ø±Ø¯ÛŒØ¨Ù‡Ø´Øª', 'Ø®Ø±Ø¯Ø§Ø¯', 'ØªÛŒØ±', 'Ù…Ø±Ø¯Ø§Ø¯', 'Ø´Ù‡Ø±ÛŒÙˆØ±', 'Ù…Ù‡Ø±', 'Ø¢Ø¨Ø§Ù†', 'Ø¢Ø°Ø±', 'Ø¯ÛŒ', 'Ø¨Ù‡Ù…Ù†', 'Ø§Ø³ÙÙ†Ø¯'][jm-1] + ' ' + jy + '</div>' +
                    '</div>' +
                    '<div class="date-column">' +
                        '<h5>ØªØ§Ø±ÛŒØ® Ù…ÛŒÙ„Ø§Ø¯ÛŒ</h5>' +
                        '<div class="date-number">' + today.getFullYear() + '-' + String(today.getMonth() + 1).padStart(2, '0') + '-' + String(today.getDate()).padStart(2, '0') + '</div>' +
                        '<div class="date-full">' + today.getDate() + ' ' + ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'][today.getMonth()] + ' ' + today.getFullYear() + '</div>' +
                    '</div>' +
                '</div>';
        }

        // Convert Persian to Gregorian
        function convertToGregorian() {
            const jy = parseInt(document.getElementById('jYear').value);
            const jm = parseInt(document.getElementById('jMonth').value);
            const jd = parseInt(document.getElementById('jDay').value);
            
            if (!jy || !jm || !jd) {
                document.getElementById('result').innerHTML = '<span style="color:#dc3545;">âŒ Ù„Ø·ÙØ§Ù‹ ØªÙ…Ø§Ù… ÙÛŒÙ„Ø¯Ù‡Ø§ Ø±Ø§ Ù¾Ø± Ú©Ù†ÛŒØ¯</span>';
                return;
            }
            
            try {
                if (typeof persianDate !== 'undefined') {
                    const persianDateObj = new persianDate([jy, jm, jd]);
                    const gregorianDateObj = persianDateObj.toCalendar('gregorian');
                    
                    const isoDate = gregorianDateObj.year() + '-' + String(gregorianDateObj.month()).padStart(2, '0') + '-' + String(gregorianDateObj.date()).padStart(2, '0');
                    document.getElementById('gDate').value = isoDate;
                    
                    // Get English month names
                    const gregMonthsEng = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
                    const gregDayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
                    
                    // Create a JavaScript Date to get day of week
                    const jsDate = new Date(gregorianDateObj.year(), gregorianDateObj.month() - 1, gregorianDateObj.date());
                    const gregDayName = gregDayNames[jsDate.getDay()];
                    const gregMonthName = gregMonthsEng[gregorianDateObj.month() - 1];
                    const gregDateFull = gregDayName + ' - ' + gregorianDateObj.date() + ' ' + gregMonthName + ', ' + gregorianDateObj.year();
                    
                    document.getElementById('result').innerHTML = 
                        '<h4>âœ… Ù†ØªÛŒØ¬Ù‡ ØªØ¨Ø¯ÛŒÙ„:</h4>' +
                        '<div class="result-grid">' +
                            '<div class="date-column">' +
                                '<h5>ØªØ§Ø±ÛŒØ® Ø®ÙˆØ±Ø´ÛŒØ¯ÛŒ</h5>' +
                                '<div class="date-number">' + jy + '/' + String(jm).padStart(2, '0') + '/' + String(jd).padStart(2, '0') + '</div>' +
                                '<div class="date-full">' + persianDateObj.format('dddd') + ' - ' + persianDateObj.format('D MMMM YYYY') + '</div>' +
                            '</div>' +
                            '<div class="date-column">' +
                                '<h5>ØªØ§Ø±ÛŒØ® Ù…ÛŒÙ„Ø§Ø¯ÛŒ</h5>' +
                                '<div class="date-number">' + isoDate + '</div>' +
                                '<div class="date-full">' + gregDateFull + '</div>' +
                            '</div>' +
                        '</div>';
                } else {
                    const gregorianResult = jalaliToGregorian(jy, jm, jd);
                    const gy = gregorianResult[0];
                    const gm = gregorianResult[1];
                    const gd = gregorianResult[2];
                    
                    const persianMonths = ['ÙØ±ÙˆØ±Ø¯ÛŒÙ†', 'Ø§Ø±Ø¯ÛŒØ¨Ù‡Ø´Øª', 'Ø®Ø±Ø¯Ø§Ø¯', 'ØªÛŒØ±', 'Ù…Ø±Ø¯Ø§Ø¯', 'Ø´Ù‡Ø±ÛŒÙˆØ±', 'Ù…Ù‡Ø±', 'Ø¢Ø¨Ø§Ù†', 'Ø¢Ø°Ø±', 'Ø¯ÛŒ', 'Ø¨Ù‡Ù…Ù†', 'Ø§Ø³ÙÙ†Ø¯'];
                    const gregMonths = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
                    
                    const isoDate = gy + '-' + String(gm).padStart(2, '0') + '-' + String(gd).padStart(2, '0');
                    document.getElementById('gDate').value = isoDate;
                    
                    document.getElementById('result').innerHTML = 
                        '<h4>âœ… Ù†ØªÛŒØ¬Ù‡ ØªØ¨Ø¯ÛŒÙ„:</h4>' +
                        '<div class="result-grid">' +
                            '<div class="date-column">' +
                                '<h5>ØªØ§Ø±ÛŒØ® Ø®ÙˆØ±Ø´ÛŒØ¯ÛŒ</h5>' +
                                '<div class="date-number">' + jy + '/' + String(jm).padStart(2, '0') + '/' + String(jd).padStart(2, '0') + '</div>' +
                                '<div class="date-full">' + jd + ' ' + persianMonths[jm-1] + ' ' + jy + '</div>' +
                            '</div>' +
                            '<div class="date-column">' +
                                '<h5>ØªØ§Ø±ÛŒØ® Ù…ÛŒÙ„Ø§Ø¯ÛŒ</h5>' +
                                '<div class="date-number">' + isoDate + '</div>' +
                                '<div class="date-full">' + gd + ' ' + gregMonths[gm-1] + ', ' + gy + '</div>' +
                            '</div>' +
                        '</div>';
                }
                
            } catch (e) {
                console.error('Conversion error:', e);
                document.getElementById('result').innerHTML = '<span style="color:#dc3545;">âŒ Ø®Ø·Ø§ Ø¯Ø± ØªØ¨Ø¯ÛŒÙ„ ØªØ§Ø±ÛŒØ®: ' + e.message + '</span>';
            }
        }

        // Convert Gregorian to Persian
        function convertToPersian() {
            const gDate = document.getElementById('gDate').value;
            if (!gDate) {
                document.getElementById('result').innerHTML = '<span style="color:#dc3545;">âŒ Ù„Ø·ÙØ§Ù‹ ØªØ§Ø±ÛŒØ® Ù…ÛŒÙ„Ø§Ø¯ÛŒ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</span>';
                return;
            }
            
            try {
                const date = new Date(gDate);
                
                if (typeof persianDate !== 'undefined') {
                    const gregorianDateObj = new persianDate(date).toCalendar('gregorian');
                    const persianDateObj = gregorianDateObj.toCalendar('persian');
                    
                    document.getElementById('jYear').value = persianDateObj.year();
                    document.getElementById('jMonth').value = persianDateObj.month();
                    document.getElementById('jDay').value = persianDateObj.date();
                    
                    // Get English month names
                    const gregMonthsEng = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
                    const gregDayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
                    
                    // Create a JavaScript Date to get day of week
                    const jsDate = new Date(gregorianDateObj.year(), gregorianDateObj.month() - 1, gregorianDateObj.date());
                    const gregDayName = gregDayNames[jsDate.getDay()];
                    const gregMonthName = gregMonthsEng[gregorianDateObj.month() - 1];
                    const gregDateFull = gregDayName + ' - ' + gregorianDateObj.date() + ' ' + gregMonthName + ', ' + gregorianDateObj.year();
                    
                    document.getElementById('result').innerHTML = 
                        '<h4>âœ… Ù†ØªÛŒØ¬Ù‡ ØªØ¨Ø¯ÛŒÙ„:</h4>' +
                        '<div class="result-grid">' +
                            '<div class="date-column">' +
                                '<h5>ØªØ§Ø±ÛŒØ® Ø®ÙˆØ±Ø´ÛŒØ¯ÛŒ</h5>' +
                                '<div class="date-number">' + persianDateObj.year() + '/' + String(persianDateObj.month()).padStart(2, '0') + '/' + String(persianDateObj.date()).padStart(2, '0') + '</div>' +
                                '<div class="date-full">' + persianDateObj.format('dddd') + ' - ' + persianDateObj.format('D MMMM YYYY') + '</div>' +
                            '</div>' +
                            '<div class="date-column">' +
                                '<h5>ØªØ§Ø±ÛŒØ® Ù…ÛŒÙ„Ø§Ø¯ÛŒ</h5>' +
                                '<div class="date-number">' + gregorianDateObj.year() + '-' + String(gregorianDateObj.month()).padStart(2, '0') + '-' + String(gregorianDateObj.date()).padStart(2, '0') + '</div>' +
                                '<div class="date-full">' + gregDateFull + '</div>' +
                            '</div>' +
                        '</div>';
                } else {
                    const gy = date.getFullYear();
                    const gm = date.getMonth() + 1;
                    const gd = date.getDate();
                    
                    const jalaliResult = gregorianToJalali(gy, gm, gd);
                    const jy = jalaliResult[0];
                    const jm = jalaliResult[1];
                    const jd = jalaliResult[2];
                    
                    const persianMonths = ['ÙØ±ÙˆØ±Ø¯ÛŒÙ†', 'Ø§Ø±Ø¯ÛŒØ¨Ù‡Ø´Øª', 'Ø®Ø±Ø¯Ø§Ø¯', 'ØªÛŒØ±', 'Ù…Ø±Ø¯Ø§Ø¯', 'Ø´Ù‡Ø±ÛŒÙˆØ±', 'Ù…Ù‡Ø±', 'Ø¢Ø¨Ø§Ù†', 'Ø¢Ø°Ø±', 'Ø¯ÛŒ', 'Ø¨Ù‡Ù…Ù†', 'Ø§Ø³ÙÙ†Ø¯'];
                    const gregMonths = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
                    
                    document.getElementById('jYear').value = jy;
                    document.getElementById('jMonth').value = jm;
                    document.getElementById('jDay').value = jd;
                    
                    document.getElementById('result').innerHTML = 
                        '<h4>âœ… Ù†ØªÛŒØ¬Ù‡ ØªØ¨Ø¯ÛŒÙ„:</h4>' +
                        '<div class="result-grid">' +
                            '<div class="date-column">' +
                                '<h5>ØªØ§Ø±ÛŒØ® Ø®ÙˆØ±Ø´ÛŒØ¯ÛŒ</h5>' +
                                '<div class="date-number">' + jy + '/' + String(jm).padStart(2, '0') + '/' + String(jd).padStart(2, '0') + '</div>' +
                                '<div class="date-full">' + jd + ' ' + persianMonths[jm-1] + ' ' + jy + '</div>' +
                            '</div>' +
                            '<div class="date-column">' +
                                '<h5>ØªØ§Ø±ÛŒØ® Ù…ÛŒÙ„Ø§Ø¯ÛŒ</h5>' +
                                '<div class="date-number">' + gy + '-' + String(gm).padStart(2, '0') + '-' + String(gd).padStart(2, '0') + '</div>' +
                                '<div class="date-full">' + gd + ' ' + gregMonths[gm-1] + ', ' + gy + '</div>' +
                            '</div>' +
                        '</div>';
                }
                
            } catch (e) {
                console.error('Conversion error:', e);
                document.getElementById('result').innerHTML = '<span style="color:#dc3545;">âŒ Ø®Ø·Ø§ Ø¯Ø± ØªØ¨Ø¯ÛŒÙ„ ØªØ§Ø±ÛŒØ®: ' + e.message + '</span>';
            }
        }

        // Clear all inputs
        function clearAll() {
            document.getElementById('jYear').value = '';
            document.getElementById('jMonth').value = '1';
            document.getElementById('jDay').value = '';
            document.getElementById('gDate').value = '';
            document.getElementById('result').innerHTML = '';
        }

        // Initialize when page loads
        window.addEventListener('load', function() {
            // Set current month/year based on today
            const today = new Date();
            const todayJalali = gregorianToJalali(today.getFullYear(), today.getMonth() + 1, today.getDate());
            currentCalendarYear = todayJalali[0];
            currentCalendarMonth = todayJalali[1];
            
            // Render calendar and show today's date
            renderCalendar();
            showTodayDate();
            setToday();
        });
    </script>
</body>
</html>
